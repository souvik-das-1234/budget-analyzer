<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Updated Comprehensive Marketing Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        :root {
            --primary-color: #2c3e50; --secondary-color: #3498db; --accent-color: #2980b9;
            --bg-color: #ecf0f1; --card-bg-color: #ffffff; --text-color: #34495e;
            --light-text-color: #7f8c8d; --success-color: #27ae60; --warning-color: #e67e22;
            --shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        body {
            font-family: 'Inter', sans-serif; background-color: var(--bg-color); color: var(--text-color);
            margin: 0; padding: 20px;
        }

        .dashboard-container { max-width: 1400px; margin: auto; display: grid; grid-template-columns: 1fr; gap: 20px; }
        .card { background-color: var(--card-bg-color); border-radius: 10px; box-shadow: var(--shadow); padding: 20px; }
        .card-header { font-size: 1.2em; font-weight: 600; margin: 0 0 20px 0; color: var(--primary-color); }

        /* Layout Grid */
        .main-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: auto;
            grid-template-areas:
                "kpi1 kpi3 kpi_roas"
                "overall overall overall"
                "leadgen leadgen leadgen"
                "compare compare forecast"
                "table chart chart";
            gap: 20px;
        }
        
        #kpi1 { grid-area: kpi1; } #kpi3 { grid-area: kpi3; } #kpi_roas { grid-area: kpi_roas; }
        #overall { grid-area: overall; } #leadgen { grid-area: leadgen; } #compare { grid-area: compare; }
        #forecast { grid-area: forecast; } #table { grid-area: table; } #chart { grid-area: chart; }

        /* KPI Cards */
        .kpi-card { display: flex; flex-direction: column; justify-content: space-between; height: 100%; }
        .kpi-card h3 { margin: 0 0 5px 0; font-size: 1em; font-weight: 500; color: var(--light-text-color); }
        .kpi-card .value { font-size: 2.2em; font-weight: 700; color: var(--primary-color); }

        /* Table */
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ecf0f1; font-size: 0.9em;}
        th { font-weight: 600; color: var(--light-text-color); }
        .highlight-row { background-color: #f8f9fa; font-weight: 500; }

        /* Tools & Summaries */
        .tool-section label { display: block; font-weight: 500; margin-bottom: 8px; font-size: 0.9em; }
        input[type="range"], input[type="number"] { width: 100%; box-sizing: border-box; }
        .output-box { background-color: var(--bg-color); padding: 10px; border-radius: 5px; }
        .output-box h4 { margin: 0 0 5px 0; font-size: 0.8em; font-weight: 500; color: var(--light-text-color); }
        .output-box p { margin: 0; font-size: 1.2em; font-weight: 600; color: var(--primary-color); }
        .placeholder-note { font-size: 0.9em; color: var(--warning-color); background-color: #fff9e6; padding: 10px; border-radius: 5px; margin-top: 10px; border-left: 3px solid var(--warning-color); }
        .insight-text { font-size: 0.9em; color: var(--accent-color); background-color: #ecf0f1; padding: 10px; border-radius: 5px; margin-top: 10px; border-left: 3px solid var(--accent-color); }
        
        /* Historical Section */
        .historical-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; }
        .quarterly-summary .output-box .value { font-size: 1.5em; }
        .quarterly-summary .output-box .label { font-size: 0.9em; }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr 1fr;
                grid-template-areas: "kpi1 kpi3" "kpi_roas ." "overall overall" "leadgen leadgen" "compare compare" "forecast forecast" "chart chart" "table table";
            }
        }
        @media (max-width: 992px) { .historical-grid { grid-template-columns: 1fr; } }
        @media (max-width: 768px) {
            body { padding: 10px; }
            .main-grid { grid-template-columns: 1fr; grid-template-areas: "kpi1" "kpi3" "kpi_roas" "overall" "leadgen" "compare" "forecast" "chart" "table"; }
        }
    </style>
</head>
<body>

    <div class="dashboard-container">
        <header class="card">
            <h1 class="card-header" style="font-size: 1.5em; margin-bottom: 0;">Comprehensive Marketing Dashboard</h1>
        </header>

        <div class="main-grid">
            <div id="kpi1" class="card kpi-card"><h3>Avg. Cost Per Lead</h3><p class="value" id="kpiCPL">₹63</p></div>
            <div id="kpi3" class="card kpi-card"><h3>Total Leads (All Time)</h3><p class="value" id="kpiTotalLeads">1,680</p></div>
            <div id="kpi_roas" class="card kpi-card"><h3>Overall ROAS (Placeholder)</h3><p class="value" id="overallRoasKpi">8.17x</p></div>
            
            <div id="overall" class="card">
                <h2 class="card-header">Overall Monthly Performance</h2>
                <div class="placeholder-note"><strong>Please Note:</strong> The Revenue and ROAS data below are for demonstration purposes. Please provide your actual revenue figures to populate this section accurately.</div>
                <div style="height:300px; margin-top: 20px;"><canvas id="overallPerformanceChart"></canvas></div>
                <table style="margin-top:20px;">
                    <thead><tr><th>Month</th><th>Total Ad Spend</th><th>Revenue (Placeholder)</th><th>ROAS (Placeholder)</th></tr></thead>
                    <tbody id="overallTableBody"></tbody>
                </table>
            </div>

            <div id="leadgen" class="card">
                <h2 class="card-header">Lead Generation Deep Dive</h2>
                <div class="historical-grid">
                    <div><div style="height:300px;"><canvas id="historicalChart"></canvas></div></div>
                    <div class="quarterly-summary">
                        <div class="output-box"><div class="label">Q2 (Apr-Jun) Summary</div><p class="value">655 Leads</p><span>Avg. CPL: <strong>₹108</strong></span></div>
                        <div class="output-box"><div class="label">Q3 (Jul-Sep) Summary</div><p class="value">880 Leads</p><span>Avg. CPL: <strong style="color: var(--success-color);">₹25</strong></span></div>
                        <p class="insight-text"><strong>Key Insight:</strong> Your campaign efficiency improved dramatically in Q3. The consolidated September campaign was highly effective, bringing the quarterly CPL down significantly.</p>
                    </div>
                </div>
            </div>

            <div id="compare" class="card">
                <h2 class="card-header">Scenario Comparison Tool</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div class="tool-section">
                        <label>Scenario A: <span id="sliderAValue"></span></label><input type="range" min="0" max="55000" value="40000" step="1000" id="sliderA">
                        <div class="output-box" style="margin-top:10px;"><h4>Leads: <span id="leadsA"></span></h4><p>Influencers: <span id="influencerA"></span></p></div>
                    </div>
                    <div class="tool-section">
                        <label>Scenario B: <span id="sliderBValue"></span></label><input type="range" min="0" max="55000" value="25000" step="1000" id="sliderB">
                        <div class="output-box" style="margin-top:10px;"><h4>Leads: <span id="leadsB"></span></h4><p>Influencers: <span id="influencerB"></span></p></div>
                    </div>
                </div>
            </div>

            <div id="forecast" class="card">
                <h2 class="card-header">Predictive Analysis</h2>
                <div class="tool-section">
                    <label for="leadTarget">Enter Monthly Lead Target:</label><input type="number" id="leadTarget" value="500">
                </div>
                 <div class="output-box"><h4>Predicted Monthly Budget</h4><p id="predictedMonthly">₹31,500</p></div>
            </div>

            <div id="chart" class="card">
                 <h2 class="card-header">Budget Split Visualizer</h2>
                 <div style="height:250px;"><canvas id="budgetChart"></canvas></div>
            </div>
            
            <div id="table" class="card">
                <h2 class="card-header">Allocation Scenarios</h2>
                <table>
                    <thead><tr><th>Scenario</th><th>Ad Budget</th><th>Influencer Budget</th></tr></thead>
                    <tbody>
                        <tr><td>Aggressive</td><td>₹45,000</td><td>₹10,000</td></tr>
                        <tr class="highlight-row"><td>Balanced</td><td>₹35,000</td><td>₹20,000</td></tr>
                        <tr><td>Influencer-Heavy</td><td>₹25,000</td><td>₹30,000</td></tr>
                    </tbody>
                </table>
            </div>

        </div>
    </div>

<script>
    // UPDATED CPL from new data analysis
    const CPL = 63;
    const TOTAL_BUDGET = 55000;

    const formatCurrency = (value) => new Intl.NumberFormat('en-IN', { style: 'currency', currency: 'INR', minimumFractionDigits: 0 }).format(value);

    // --- Overall Performance Data (UPDATED & CONSOLIDATED) ---
    const monthlyLabels = ['April', 'May', 'June', 'July', 'August', 'September'];
    const totalMetaSpend = [29600, 29848, 29778, 22230, 22612, 13621]; // Sep includes Oct data
    const googleSpend = [15000, 15000, 15000, 15000, 15000, 15000]; 
    const totalCombinedSpend = totalMetaSpend.map((spend, i) => spend + googleSpend[i]);
    
    // --- !! PLACEHOLDER REVENUE DATA (CONSOLIDATED) !! ---
    const revenueData = [150000, 180000, 250000, 300000, 280000, 400000]; // Sep includes Oct data
    
    const roasData = totalCombinedSpend.map((spend, i) => spend > 0 ? (revenueData[i] / spend) : 0);

    const overallTableBody = document.getElementById('overallTableBody');
    monthlyLabels.forEach((month, i) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${month}</td>
            <td>${formatCurrency(totalCombinedSpend[i])}</td>
            <td>${formatCurrency(revenueData[i])}</td>
            <td>${roasData[i].toFixed(2)}x</td>
        `;
        overallTableBody.appendChild(row);
    });
    
    const totalRevenue = revenueData.reduce((a, b) => a + b, 0);
    const totalSpendOverall = totalCombinedSpend.reduce((a, b) => a + b, 0);
    const overallRoas = totalSpendOverall > 0 ? (totalRevenue / totalSpendOverall) : 0;
    document.getElementById('overallRoasKpi').innerText = `${overallRoas.toFixed(2)}x`;
    
    new Chart(document.getElementById('overallPerformanceChart'), {
        type: 'bar',
        data: {
            labels: monthlyLabels,
            datasets: [
                { label: 'Total Ad Spend', data: totalCombinedSpend, backgroundColor: '#7f8c8d', yAxisID: 'y' },
                { label: 'Revenue', data: revenueData, backgroundColor: '#27ae60', yAxisID: 'y' },
                { label: 'ROAS', data: roasData, type: 'line', borderColor: '#c0392b', yAxisID: 'y1', tension: 0.3 }
            ]
        },
        options: {
            responsive: true, maintainAspectRatio: false,
            scales: {
                y: { type: 'linear', position: 'left', title: { display: true, text: 'Amount (₹)' } },
                y1: { type: 'linear', position: 'right', title: { display: true, text: 'ROAS (x)' }, grid: { drawOnChartArea: false } }
            }
        }
    });

    // --- Lead Generation Deep Dive Data & Chart (UPDATED, CONSOLIDATED & SIMPLIFIED CHART) ---
    const historicalData = {
        labels: ['April', 'May', 'June', 'July', 'August', 'September'],
        spend: [23778, 23373, 23274, 13137, 15542, 5953], // Sep includes Oct
        leads: [187, 275, 193, 254, 266, 505], // Sep includes Oct
        cpl: [127, 85, 121, 52, 58, 12] // Sep includes Oct
    };
    const totalLeadsAllTime = historicalData.leads.reduce((a,b) => a+b, 0);
    document.getElementById('kpiCPL').innerText = formatCurrency(CPL);
    document.getElementById('kpiTotalLeads').innerText = totalLeadsAllTime.toLocaleString('en-IN');
    
    new Chart(document.getElementById('historicalChart'), {
        type: 'bar',
        data: {
            labels: historicalData.labels,
            datasets: [
                {
                    label: 'Ad Spend',
                    data: historicalData.spend,
                    backgroundColor: 'rgba(127, 140, 141, 0.6)',
                    yAxisID: 'y'
                },
                {
                    label: 'Cost Per Lead (CPL)',
                    data: historicalData.cpl,
                    type: 'line',
                    borderColor: '#e67e22',
                    backgroundColor: '#e67e22',
                    yAxisID: 'y1',
                    tension: 0.3
                }
            ]
        },
        options: {
            responsive: true, maintainAspectRatio: false,
            scales: {
                y: { position: 'left', title: { display: true, text: 'Ad Spend (₹)' } },
                y1: { position: 'right', title: { display: true, text: 'CPL (₹)' }, grid: { drawOnChartArea: false } }
            }
        }
    });

    // --- Scenario Comparison Tool ---
    const sliderA = document.getElementById('sliderA');
    const sliderB = document.getElementById('sliderB');
    function updateComparisonTool() {
        const valA = parseInt(sliderA.value), valB = parseInt(sliderB.value);
        document.getElementById('sliderAValue').innerText = formatCurrency(valA);
        document.getElementById('sliderBValue').innerText = formatCurrency(valB);
        
        const leadsA = Math.floor(valA / CPL), influencerA = TOTAL_BUDGET - valA;
        document.getElementById('leadsA').innerText = leadsA.toLocaleString('en-IN');
        document.getElementById('influencerA').innerText = formatCurrency(influencerA);

        const leadsB = Math.floor(valB / CPL), influencerB = TOTAL_BUDGET - valB;
        document.getElementById('leadsB').innerText = leadsB.toLocaleString('en-IN');
        document.getElementById('influencerB').innerText = formatCurrency(influencerB);
    }
    sliderA.addEventListener('input', updateComparisonTool);
    sliderB.addEventListener('input', updateComparisonTool);

    // --- Predictive Analysis Tool ---
    const leadTargetInput = document.getElementById('leadTarget');
    function updatePredictionTool() {
        const target = parseInt(leadTargetInput.value) || 0;
        document.getElementById('predictedMonthly').innerText = formatCurrency(target * CPL);
    }
    leadTargetInput.addEventListener('input', updatePredictionTool);

    // --- Budget Split Chart ---
    new Chart(document.getElementById('budgetChart'), {
        type: 'bar',
        data: {
            labels: ['Aggressive', 'Balanced', 'Influencer-Heavy'],
            datasets: [
                { label: 'Ad Spend', data: [45000, 35000, 25000], backgroundColor: '#3498db' },
                { label: 'Influencer Spend', data: [10000, 20000, 30000], backgroundColor: '#95a5a6' }
            ]
        },
        options: {
            responsive: true, maintainAspectRatio: false,
            scales: { x: { stacked: true }, y: { stacked: true, ticks: { callback: (value) => `₹${value/1000}k` } } }
        }
    });
    
    // --- Initial function calls ---
    updateComparisonTool();
    updatePredictionTool();
</script>
</body>
</html>
